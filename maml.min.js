var F={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function b(i){if(typeof i!="string")throw TypeError("Source must be a string");let s=0,y=1,e,l=!1;r();let h=c();if(a(),!l)throw new SyntaxError(f());return E(h),h;function r(){s<i.length?(e=i[s],s++):(e="",l=!0),e===`
`&&y++}function u(){return i.substring(s,s+2)}function c(){return a(),$()??d()??I()??k()??M()??g("true",!0)??g("false",!1)??g("null",null)}function d(){if(e!=='"')return;let n="",t=!1;for(;;)if(r(),t){if(e==="u"){let o="";for(let w=0;w<4;w++){if(r(),!C(e))throw new SyntaxError(f("Invalid Unicode escape sequence"));o+=e}n+=String.fromCharCode(parseInt(o,16))}else{let o=F[e];if(!o)throw new SyntaxError(f(`Invalid escape sequence ${JSON.stringify(e)}`));n+=o}t=!1}else if(e==="\\")t=!0;else{if(e==='"')break;if(e===`
`)throw new SyntaxError(f('Use """ for multiline strings or escape newlines with "\\n"'));if(e<"")throw new SyntaxError(f(`Unescaped control character ${JSON.stringify(e)}`));n+=e}return r(),n}function $(){if(e!=='"'||u()!=='""')return;r(),r(),r();let n=!1;e===`
`&&(n=!0,r());let t="";for(;!l;){if(e==='"'&&u()==='""'){if(r(),r(),r(),t===""&&!n)throw new SyntaxError(f("Multiline strings cannot be empty"));return t}t+=e,r()}throw new SyntaxError(f())}function I(){if(!p(e)&&e!=="-")return;let n="",t=!1;if(e==="-"&&(n+=e,r(),!p(e)))throw new SyntaxError(f());if(e==="0")n+=e,r();else for(;p(e);)n+=e,r();if(e==="."){if(t=!0,n+=e,r(),!p(e))throw new SyntaxError(f());for(;p(e);)n+=e,r()}if(e==="e"||e==="E"){if(t=!0,n+=e,r(),(e==="+"||e==="-")&&(n+=e,r()),!p(e))throw new SyntaxError(f());for(;p(e);)n+=e,r()}return t?parseFloat(n):U(n)}function k(){if(e!=="{")return;r(),a();let n={};if(e==="}")return r(),n;for(;;){let t=s,o;if(e==='"'?o=d():o=O(),Object.prototype.hasOwnProperty.call(n,o))throw s=t,new SyntaxError(f(`Duplicate key ${JSON.stringify(o)}`));if(a(),e!==":")throw new SyntaxError(f());r();let w=c();E(w),n[o]=w;let x=a();if(e==="}")return r(),n;if(e===","){if(r(),a(),e==="}")return r(),n}else{if(x)continue;throw new SyntaxError(f("Expected comma or newline between key-value pairs"))}}}function O(){let n="";for(;J(e);)n+=e,r();if(n==="")throw new SyntaxError(f());return n}function M(){if(e!=="[")return;r(),a();let n=[];if(e==="]")return r(),n;for(;;){let t=c();E(t),n.push(t);let o=a();if(e==="]")return r(),n;if(e===","){if(r(),a(),e==="]")return r(),n}else{if(o)continue;throw new SyntaxError(f("Expected comma or newline between values"))}}}function g(n,t){if(e===n[0]){for(let o=1;o<n.length;o++)if(r(),e!==n[o])throw new SyntaxError(f());if(r(),A(e)||e===","||e==="}"||e==="]"||e===void 0)return t;throw new SyntaxError(f())}}function a(){let n=!1;for(;A(e);)n||=e===`
`,r();let t=_();return n||t}function _(){if(e==="#"){for(;!l&&e!==`
`;)r();return a()}return!1}function A(n){return n===" "||n===`
`||n==="	"||n==="\r"}function C(n){return n>="0"&&n<="9"||n>="A"&&n<="F"}function p(n){return n>="0"&&n<="9"}function J(n){return n>="A"&&n<="Z"||n>="a"&&n<="z"||n>="0"&&n<="9"||n==="_"||n==="-"}function U(n){if(n=="-0")return-0;let t=Number(n);return t>=Number.MIN_SAFE_INTEGER&&t<=Number.MAX_SAFE_INTEGER?t:BigInt(n)}function E(n){if(n===void 0)throw new SyntaxError(f())}function f(n=`Unexpected character ${JSON.stringify(e)}`){e||(n="Unexpected end of input");let t=i.substring(s-40,s).split(`
`),o=t.at(-1)||"",w=i.substring(s,s+40).split(`
`,1).at(0)||"";o===""&&(o=t.at(-2)||"",o+=" ",y--,w="");let x=`    ${o}${w}
`,j=`    ${".".repeat(Math.max(0,o.length-1))}^
`;return`${n} on line ${y}.

${x}${j}`}}function N(i){return m(i,0)}function m(i,s){let y=i===null?"null":Array.isArray(i)?"array":typeof i;switch(y){case"string":return JSON.stringify(i);case"boolean":case"bigint":case"number":return`${i}`;case"null":case"undefined":return"null";case"array":{let e=i.length;if(e===0)return"[]";let l=S(s+1),h=S(s),r=`[
`;for(let u=0;u<e;u++)u>0&&(r+=`
`),r+=l+m(i[u],s+1);return r+`
`+h+"]"}case"object":{let e=Object.keys(i),l=e.length;if(l===0)return"{}";let h=S(s+1),r=S(s),u=`{
`;for(let c=0;c<l;c++){c>0&&(u+=`
`);let d=e[c];u+=h+L(d)+": "+m(i[d],s+1)}return u+`
`+r+"}"}default:throw new Error(`Unsupported value type: ${y}`)}}var K=/^[A-Za-z0-9_-]+$/;function L(i){return K.test(i)?i:JSON.stringify(i)}function S(i){return" ".repeat(2*i)}globalThis.MAML={parse:b,stringify:N};
