function S(t){if(typeof t!="string")throw TypeError("Source must be a string");let s=0,a=1,e,l=!1;r();let E=y();if(u(),!l)throw new SyntaxError(f());return g(E),E;function r(){s<t.length?(e=t[s],s++):(e="",l=!0),e===`
`&&a++}function m(){return t.substring(s,s+2)}function y(){return u(),$()??b()??A()??I()??O()??h("true",!0)??h("false",!1)??h("null",null)}function b(){if(e!=='"')return;let n="",i=!1;for(;;)if(r(),i){if(e==="u"){let o="";for(let c=0;c<4;c++){if(r(),!U(e))throw new SyntaxError(f("Invalid Unicode escape sequence"));o+=e}n+=String.fromCharCode(parseInt(o,16))}else{let o={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"}[e];if(!o)throw new SyntaxError(f(`Invalid escape sequence ${JSON.stringify(e)}`));n+=o}i=!1}else if(e==="\\")i=!0;else{if(e==='"')break;if(e===`
`)throw new SyntaxError(f('Use """ for multiline strings or escape newlines with "\\n"'));if(e<"")throw new SyntaxError(f(`Unescaped control character ${JSON.stringify(e)}`));n+=e}return r(),n}function $(){if(e!=='"'||m()!=='""')return;r(),r(),r();let n=!1;e===`
`&&(n=!0,r());let i="";for(;!l;){if(e==='"'&&m()==='""'){if(r(),r(),r(),i===""&&!n)throw new SyntaxError(f("Multiline strings cannot be empty"));return i}i+=e,r()}throw new SyntaxError(f())}function A(){if(!p(e)&&e!=="-")return;let n="";if(e==="-"&&(n+=e,r(),!p(e)))throw new SyntaxError(f());if(e==="0")n+=e,r();else for(;p(e);)n+=e,r();if(e==="."){if(n+=e,r(),!p(e))throw new SyntaxError(f());for(;p(e);)n+=e,r()}if(e==="e"||e==="E"){if(n+=e,r(),(e==="+"||e==="-")&&(n+=e,r()),!p(e))throw new SyntaxError(f());for(;p(e);)n+=e,r()}return _(n)?k(n):parseFloat(n)}function I(){if(e!=="{")return;r(),u();let n={};if(e==="}")return r(),n;for(;;){let i;if(e==='"'?i=b():i=M(),u(),e!==":")throw new SyntaxError(f());r();let o=y();g(o),n[i]=o;let c=u();if(e==="}")return r(),n;if(e===","){if(r(),u(),e==="}")return r(),n}else{if(c)continue;throw new SyntaxError(f("Expected comma or newline between key-value pairs"))}}}function M(){let n="";for(;/[A-Za-z0-9_-]/.test(e);)n+=e,r();if(n==="")throw new SyntaxError(f());return n}function O(){if(e!=="[")return;r(),u();let n=[];if(e==="]")return r(),n;for(;;){let i=y();g(i),n.push(i);let o=u();if(e==="]")return r(),n;if(e===","){if(r(),u(),e==="]")return r(),n}else{if(o)continue;throw new SyntaxError(f("Expected comma or newline between values"))}}}function h(n,i){if(e===n[0]){for(let o=1;o<n.length;o++)if(r(),e!==n[o])throw new SyntaxError(f());if(r(),N(e)||e===","||e==="}"||e==="]"||e===void 0)return i;throw new SyntaxError(f())}}function u(){let n=!1;for(;N(e);)n||=e===`
`,r();let i=j();return n||i}function j(){if(e==="#"){for(;!l&&e!==`
`;)r();return u()}return!1}function N(n){return n===" "||n===`
`||n==="	"||n==="\r"}function U(n){return n>="0"&&n<="9"||n>="A"&&n<="F"}function p(n){return n>="0"&&n<="9"}function _(n){return/^-?[0-9]+$/.test(n)}function k(n){if(n=="-0")return-0;let i=BigInt(n);return i>=Number.MIN_SAFE_INTEGER&&i<=Number.MAX_SAFE_INTEGER?Number(i):i}function g(n){if(n===void 0)throw new SyntaxError(f())}function f(n=`Unexpected character ${JSON.stringify(e)}`){e||(n="Unexpected end of input");let i=t.substring(s-40,s).split(`
`),o=i.at(-1)||"",c=t.substring(s,s+40).split(`
`,1).at(0)||"";o===""&&(o=i.at(-2)||"",o+=" ",a--,c="");let C=`    ${o}${c}
`,F=`    ${".".repeat(Math.max(0,o.length-1))}^
`;return`${n} on line ${a}.

${C}${F}`}}function d(t){return x(t,0)}function x(t,s){if(typeof t=="string")return JSON.stringify(t);if(typeof t=="number")return`${t}`;if(typeof t=="bigint")return`${t}`;if(typeof t=="boolean")return`${t}`;if(t===null||typeof t>"u")return"null";if(Array.isArray(t))return t.length===0?"[]":`[
`+t.map(e=>w(s+1)+x(e,s+1)).join(`
`)+`
`+w(s)+"]";if(typeof t=="object"){let a=Object.keys(t);return a.length===0?"{}":`{
`+a.map(l=>w(s+1)+J(l)+": "+x(t[l],s+1)).join(`
`)+`
`+w(s)+"}"}throw new Error(`Unsupported value type: ${typeof t}`)}function J(t){return/^[A-Za-z0-9_-]+$/.test(t)?t:JSON.stringify(t)}function w(t){return" ".repeat(2*t)}globalThis.MAML={parse:S,stringify:d};
