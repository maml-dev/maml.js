var K={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function x(i){if(typeof i!="string")throw TypeError("Source must be a string");let f=0,y=1,e,l=!1;r();let h=c();if(a(),!l)throw new SyntaxError(s());return E(h),h;function r(){f<i.length?(e=i[f],f++):(e="",l=!0),e===`
`&&y++}function u(){return i.substring(f,f+2)}function c(){return a(),A()??d()??$()??I()??M()??g("true",!0)??g("false",!1)??g("null",null)}function d(){if(e!=='"')return;let n="",t=!1;for(;;)if(r(),t){if(e==="u"){let o="";for(let p=0;p<4;p++){if(r(),!C(e))throw new SyntaxError(s("Invalid Unicode escape sequence"));o+=e}n+=String.fromCharCode(parseInt(o,16))}else{let o=K[e];if(!o)throw new SyntaxError(s(`Invalid escape sequence ${JSON.stringify(e)}`));n+=o}t=!1}else if(e==="\\")t=!0;else{if(e==='"')break;if(e===`
`)throw new SyntaxError(s('Use """ for multiline strings or escape newlines with "\\n"'));if(e<"")throw new SyntaxError(s(`Unescaped control character ${JSON.stringify(e)}`));n+=e}return r(),n}function A(){if(e!=='"'||u()!=='""')return;r(),r(),r();let n=!1;e===`
`&&(n=!0,r());let t="";for(;!l;){if(e==='"'&&u()==='""'){if(r(),r(),r(),t===""&&!n)throw new SyntaxError(s("Multiline strings cannot be empty"));return t}t+=e,r()}throw new SyntaxError(s())}function $(){if(!w(e)&&e!=="-")return;let n="",t=!1;if(e==="-"&&(n+=e,r(),!w(e)))throw new SyntaxError(s());if(e==="0")n+=e,r();else for(;w(e);)n+=e,r();if(e==="."){if(t=!0,n+=e,r(),!w(e))throw new SyntaxError(s());for(;w(e);)n+=e,r()}if(e==="e"||e==="E"){if(t=!0,n+=e,r(),(e==="+"||e==="-")&&(n+=e,r()),!w(e))throw new SyntaxError(s());for(;w(e);)n+=e,r()}return t?parseFloat(n):U(n)}function I(){if(e!=="{")return;r(),a();let n={};if(e==="}")return r(),n;for(;;){let t;if(e==='"'?t=d():t=k(),a(),e!==":")throw new SyntaxError(s());r();let o=c();E(o),n[t]=o;let p=a();if(e==="}")return r(),n;if(e===","){if(r(),a(),e==="}")return r(),n}else{if(p)continue;throw new SyntaxError(s("Expected comma or newline between key-value pairs"))}}}function k(){let n="";for(;O(e);)n+=e,r();if(n==="")throw new SyntaxError(s());return n}function M(){if(e!=="[")return;r(),a();let n=[];if(e==="]")return r(),n;for(;;){let t=c();E(t),n.push(t);let o=a();if(e==="]")return r(),n;if(e===","){if(r(),a(),e==="]")return r(),n}else{if(o)continue;throw new SyntaxError(s("Expected comma or newline between values"))}}}function g(n,t){if(e===n[0]){for(let o=1;o<n.length;o++)if(r(),e!==n[o])throw new SyntaxError(s());if(r(),N(e)||e===","||e==="}"||e==="]"||e===void 0)return t;throw new SyntaxError(s())}}function a(){let n=!1;for(;N(e);)n||=e===`
`,r();let t=_();return n||t}function _(){if(e==="#"){for(;!l&&e!==`
`;)r();return a()}return!1}function N(n){return n===" "||n===`
`||n==="	"||n==="\r"}function C(n){return n>="0"&&n<="9"||n>="A"&&n<="F"}function w(n){return n>="0"&&n<="9"}function O(n){return n>="A"&&n<="Z"||n>="a"&&n<="z"||n>="0"&&n<="9"||n==="_"||n==="-"}function U(n){if(n=="-0")return-0;let t=Number(n);return t>=Number.MIN_SAFE_INTEGER&&t<=Number.MAX_SAFE_INTEGER?t:BigInt(n)}function E(n){if(n===void 0)throw new SyntaxError(s())}function s(n=`Unexpected character ${JSON.stringify(e)}`){e||(n="Unexpected end of input");let t=i.substring(f-40,f).split(`
`),o=t.at(-1)||"",p=i.substring(f,f+40).split(`
`,1).at(0)||"";o===""&&(o=t.at(-2)||"",o+=" ",y--,p="");let F=`    ${o}${p}
`,J=`    ${".".repeat(Math.max(0,o.length-1))}^
`;return`${n} on line ${y}.

${F}${J}`}}function m(i){return b(i,0)}function b(i,f){let y=i===null?"null":Array.isArray(i)?"array":typeof i;switch(y){case"string":return JSON.stringify(i);case"boolean":case"bigint":case"number":return`${i}`;case"null":case"undefined":return"null";case"array":{let e=i.length;if(e===0)return"[]";let l=S(f+1),h=S(f),r=`[
`;for(let u=0;u<e;u++)u>0&&(r+=`
`),r+=l+b(i[u],f+1);return r+`
`+h+"]"}case"object":{let e=Object.keys(i),l=e.length;if(l===0)return"{}";let h=S(f+1),r=S(f),u=`{
`;for(let c=0;c<l;c++){c>0&&(u+=`
`);let d=e[c];u+=h+L(d)+": "+b(i[d],f+1)}return u+`
`+r+"}"}default:throw new Error(`Unsupported value type: ${y}`)}}var j=/^[A-Za-z0-9_-]+$/;function L(i){return j.test(i)?i:JSON.stringify(i)}function S(i){return" ".repeat(2*i)}globalThis.MAML={parse:x,stringify:m};
